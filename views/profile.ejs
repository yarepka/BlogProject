<!DOCTYPE html>
<html lang="en">

<!-- Header -->
<%- include("./partials/header") -%>

<body>
  <!-- Navbar -->
  <%- include("./partials/navbar") -%>

  <section id="main-profile">
    <div class="container">
      <div class="profile-header">
        <aside class="profile box mb-10">
          <div class="profile-image-container">
            <div class="profile-image-wrapper">
              <img class="profile-image" src="./img/<%= profileImage %>">
              <form id="add-profile-image" method="POST" enctype="multipart/form-data" autocomplete="off">
                <label for="image-file">
                  <i class="fas fa-pencil-alt"></i>
                  <input type="file" id="image-file" name="profile-image">
                </label>
                <button id="add-profile-image-submit" type="submit" class="no-display"></button>
              </form>
            </div>

            <div class="registered-date">
              <p>Cake day</p>
              <span class="date"><%= cakeDay %></span>
            </div>
          </div>

          <a href="/posts/add-post" class="btn btn-blue">
            new post
          </a>
        </aside>

        <aside class="communities box mb-10">
          <ul class="communities-list">
            <% communities.forEach(community => { %>
            <li data-id="<%= community._id %>">
              <a href="/communities/<%= community._id %>">
                <img src="<%= community.mainImagePath %>" class="community-image-small">
                <p class="community-name"><%= community.name %></p>
              </a>
              <% if(login) { %>
              <a class="btn <%= community.isJoined? "quit" : "join" %>"
                href=""><%= community.isJoined? "quit" : "join" %></a>
              <% } %>
            </li>
            <% }) %>
          </ul>

          <a class="btn btn-blue view" href="/communities/">View All</a>
        </aside>
      </div>

      <% if(hasPosts) { %>
      <div class="posts">
        <h3 class="mb-10">Your Posts:</h3>
        <!-- Controls -->
        <%- include("./partials/controls") -%>

        <!-- Posts -->
        <div class="posts-container">
        </div>
      </div>
      <% } else { %>
      <div class="no-post">
        <h2>You haven't posted anything yet!</h2>
        <a href="/posts/add-post" class="btn">Make My First Post</a>
      </div>
      <% } %>
    </div>
  </section>

  <!-- Login & Sign Up forms -->
  <%- include("./partials/loginSignupForms") -%>

  <!-- Footer -->
  <%- include("./partials/footer") -%>

  <script src="./js/globalFunctions.js" type="text/javascript"></script>
  <script src="./js/server.js" type="text/javascript"></script>
  <script src="./js/ui.js" type="text/javascript"></script>
  <script src="./js/postLayoutControls.js" type="text/javascript"></script>
  <script src="./js/main.js" type="text/javascript"></script>
  <script src="./js/loadPosts.js" type="text/javascript"></script>
  <script src="./js/subscribtionManager.js" type="text/javascript"></script>
  <script src="./js/profileMain.js" type="text/javascript"></script>
</body>

</html>